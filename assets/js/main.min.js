function ajaxCallback(a,e,t){$.ajax({url:"assets/data/"+a,method:e,dataType:"json",success:t,error:function(a){console.error(a.responseText)}})}function setToLS(a,e){localStorage.setItem(a,e),refreshIcon()}function getFromLS(a){return localStorage.getItem(a)}function deleteFromLS(a){localStorage.removeItem(a),refreshIcon()}function ispisNavigacije(a){let e='\n    <a class="navbar-brand" href="index.html">PC Center</a>\n    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo02" aria-controls="navbarTogglerDemo02" aria-expanded="false" aria-label="Toggle navigation">\n      <span class="navbar-toggler-icon"></span>\n    </button>\n    \n    \n    <div class="collapse navbar-collapse" id="navbarTogglerDemo02">\n      <ul class="navbar-nav mr-auto mt-2 mt-lg-0" id="navigation">';for(let t of a)e+=`<li class="nav-item">\n        <a class="nav-link" href="${t.href}">${t.text}</a>\n      </li>`;e+='</ul>\n    <a href="korpa.html"class="btn btn-primary">Korpa<i class="fas fa-shopping-cart"></i> <span class="badge badge-light"></span></a>\n    </div>\n    </nav>',$("#navigation").html(e),refreshIcon()}function ispisKat(a){let e="";kategorije=a;for(let t of a)e+=`<li class="list-group-item">\n      <input type="checkbox" value="${t.id}" class="category" name="categories"/> ${t.name}\n    </li>`;$("#categories").html(e),ajaxCallback("brands.json","get",function(a){ispisBrend(a)})}function ispisBrend(a){let e="";brendovi=a;for(let t of a)e+=`<li class="list-group-item">\n      <input type="checkbox" value="${t.id}" class="brand" name="brands"/> ${t.name}\n    </li>`;$("#brands").html(e),ajaxCallback("products.json","get",function(a){ispisProizvoda(a)})}function ispisProizvoda(a){let e="";if((a=search(a=catFilter(a=sortiraj(a=brandFilter(a))))).length>0)for(proizvod of a)e+=`<div class="col-12 col-sm-6 col-md-4 mt-2">\n      <div class="card">\n          <img src="assets/img/${proizvod.img.src}" class="card-img-top" alt="${proizvod.img.alt}">\n          <div class="card-body">\n            <h5 class="card-title">${proizvod.name}</h5><hr/>\n            <p class="card-text m-0">Proizvodjac: ${getName(brendovi,proizvod.brand)}</p>\n            <p class="card-text m-0">Kategorija: ${getName(kategorije,proizvod.category)}</p>`,e+=getProps(proizvod.properties),e+=`<hr/><p class="card-text font-weight-bold m-0">Cena: ${proizvod.price},00 RSD</p>\n            <a href="#!" class="btn btn-primary mt-2 addToCart" data-id=${proizvod.id}>Dodaj u korpu</a>\n            <p class="text-success"></p>\n          </div>\n        </div>\n      </div>`;else e='<div class="container m-5 alert alert-danger"><p>Nema proizvoda koji odgovaraju vašoj pretrazi.</p></div>';$("#products").html(e)}function getProps(a){let e="";for(let t of a)e+=`<p class="card-text m-0">${t}</p>`;return e}function getName(a,e){return a.filter(a=>a.id==e)[0].name}function sortiraj(a){return"asc"==$("#sort").val()?a.sort((a,e)=>a.price>e.price?1:-1):a.sort((a,e)=>a.price<e.price?1:-1)}function brandFilter(a){let e=[];return $(".brand:checked").each(function(a){e.push(parseInt($(this).val()))}),0!=e.length?a.filter(a=>e.includes(a.brand)):a}function catFilter(a){let e=[];return $(".category:checked").each(function(a){e.push(parseInt($(this).val()))}),0!=e.length?a.filter(a=>e.includes(a.category)):a}function search(a){let e=$("#search").val().toLowerCase();return e?a.filter(a=>-1!=a.name.toLowerCase().indexOf(e)):a}function promena(){ajaxCallback("products.json","get",function(a){ispisProizvoda(a)})}function addToCart(){let a=$(this).data("id"),e=getFromLS("cart");if(e&&e.length){let t,i=JSON.parse(e);i.find((e,i)=>e.id==a&&(t=i,!0))?i[t].quantity++:i.push({id:a,quantity:1}),e=i}else e=[{id:a,quantity:1}];setToLS("cart",JSON.stringify(e)),poruka($(this).next())}function poruka(a){a.html('<i class="fas fa-check"></i>Uspesno dodato'),setTimeout(function(){a.html("")},3e3),clearTimeout()}function ispisKorpe(a){let e=getFromLS("cart"),t="",i=JSON.parse(e);i&&i.length>0?(i.forEach(e=>{let i=a.find(a=>a.id==e.id);t+=`<div class="row mx-0 my-2 align-items-center border p-3">\n      <div class="col-4 col-lg-2">\n      <img class="img-fluid" src="assets/img/${i.img.src}" alt="${i.img.alt}"/>\n      </div>\n      <div class="col-8 col-lg-5">\n      <h4>${i.name}</h4>\n      </div>\n      <div class="col-6 col-lg-3 mt-3 mt-lg-0">\n        <p>Količina</p>\n        <input type="number" class="itemQuantity" data-id="${i.id}" min="1" value="${e.quantity}"/>\n        <span class="font-weight-bold">${i.price*e.quantity} RSD</span>\n      </div>\n      <div class="col-6 col-lg-2 text-right">\n        <a href="#!" class="btn btn-danger obrisi" data-id="${i.id}">Ukloni</a> \n      </div>\n      </div>`}),$("#korpa").html(t),ukupnaCena(i,a),$(".itemQuantity").change(function(){let e=$(this).val();for(let t in i)if(i[t].id==$(this).data("id")){i[t].quantity=e;let n=a.find(a=>a.id==i[t].id);$(this).next().html(n.price*i[t].quantity+"RSD"),ukupnaCena(i,a);break}setToLS("cart",JSON.stringify(i))}),$(".obrisi").click(function(){$(this).data("id");for(let a in i)if(i[a].id==$(this).data("id")){i.splice(a,1);break}setToLS("cart",JSON.stringify(i)),ispisKorpe(a)})):$("#korpa").html('<div class="container m-5 alert alert-danger"><p>Nemate ništa u korpi. Pogledajte <a href="proizvodi.html">prodavnicu</a></p></div>')}function ukupnaCena(a,e){let t=0;a.forEach(a=>{let i=e.find(e=>e.id==a.id);t+=i.price*a.quantity}),$(".total").remove(),$("#korpa").append(`<div class="total w-100 text-right pb-3"><p>Ukupna cena je <span class="font-weight-bold">${t}</span></p><a href="#!" id="obrisiSve" class="btn btn-danger">Ukloni sve</a> <a href="#!" id="order" class="btn btn-primary">Naručite</a></div>`),$("#obrisiSve").click(function(){ukloniSve(ispisKorpe)}),$("#order").click(function(){ukloniSve(order)})}function ukloniSve(a){deleteFromLS("cart"),a()}function order(){$("#korpa").html('<div class="container m-5 alert alert-success"><p>Uspešno ste poručili. <a href="proizvodi.html">Nastavite sa kupovinom</a></p></div>')}function refreshIcon(){let a=getFromLS("cart")&&JSON.parse(getFromLS("cart")).length?String(JSON.parse(getFromLS("cart")).length):"";$(".badge").text(a)}function ukloniGreske(){$(".greska").hide(),$(".uspeh").hide()}function greskaForme(a,e){$(a).next().text(e).fadeIn()}$("document").ready(function(){ajaxCallback("nav.json","get",ispisNavigacije),$("#categories").length&&ajaxCallback("categories.json","get",function(a){ispisKat(a)}),$("#korpa").length&&ajaxCallback("products.json","get",function(a){ispisKorpe(a)}),$("#sort").change(promena),$(document).on("change",".brand",promena),$(document).on("change",".category",promena),$("#search").keyup(promena),$(document).on("click",".addToCart",addToCart)});var izrazImePrezime=/^[A-ZŠĐČĆŽ][a-zšđčćž]{1,16}(\s[A-ZŠĐČĆŽ][a-zšđčćž]{2,16})*$/,izrazMejl=/^([a-z]{3,15})(([\.]?[-]?[_]?[a-z]{3,20})*([\d]{1,3})*)@([a-z]{3,20})(\.[a-z]{2,3})+$/;$(document.conForm).on("submit",function(a){a.preventDefault(),ukloniGreske();let e=document.conForm,t=!1;izrazImePrezime.test(e.imeFuter.value)||(greskaForme(e.imeFuter,"Ime i prezime moraju početi velikim slovom i imati po više od dva slova."),t=!0),izrazMejl.test(e.mejlFuter.value)||(greskaForme(e.mejlFuter,"Unesite email u pravilnoj formi(primer: vaseime@gmail.com)."),t=!0),""==e.poruka.value.length&&(greskaForme(e.poruka,"Molimo unesite poruku."),t=!0),t||($("#btnSubmitFuter").next().text("Uspešno poslato!").fadeIn(),e.reset())});